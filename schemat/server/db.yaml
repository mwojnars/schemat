- __id:
    - 0
    - 0
  entries:
    - key: name
      value: Category
    - key: info
      value: Category of items that represent categories
    - key: class_name
      value: schemat.item.Category
    - key: cache_ttl
      value: 60
    - key: fields
      value:
        entries:
          - key: name
            value:
              info: human-readable title of the category
              "@": schemat.type.STRING
          - key: info
            value:
              "@": schemat.type.TEXT
          - key: startup_site
            value:
              "@": schemat.type.GENERIC
          - key: base_category
            value:
              info: Base category from which this one inherits properties. Multiple bases are
                allowed, the first one has priority over subsequent ones.
              "@": schemat.type.ITEM
          - key: class_name
            value:
              info: Full (dotted) path of a JS class.
              default: schemat.item.Item
              "@": schemat.type.STRING
          - key: class_body
            value:
              info: Body of a subclass that will be created for this category. The subclass
                will inherit from the class of the first `base_category`, or
                from the top-level Item class.
              "@": schemat.type.CODE
          - key: handlers
            value:
              info: Methods for server-side handling of web requests.
              isCatalog: true
              values:
                "@": schemat.type.CODE
              "@": schemat.type.CATALOG
          - key: fields
            value:
              info: Fields must have unique names.
              isCatalog: true
              values:
                "@": schemat.type.SCHEMA
              "@": schemat.type.CATALOG
          - key: cache_ttl
            value:
              info: Time To Live (TTL). Determines for how long (in seconds) an item of this
                category is kept in a server-side cache after being loaded from
                DB, for reuse by subsequent requests. A real number. If zero,
                the items are evicted immediately after each request.
              default: 5
              "@": schemat.type.NUMBER
        "@": schemat.data.Catalog
    - key: startup_site
      value:
        - 12
        - 1
  "@": schemat.data.Data
- __id:
    - 0
    - 1
  name: Database
  info: Base category for items that represent an abstract database layer.
- __id:
    - 0
    - 2
  name: YAML Database
  info: Single-machine database stored in a YAML file.
  class_name: schemat.item.DatabaseYaml
  base_category:
    - 0
    - 1
  fields:
    filename:
      "@": schemat.type.STRING
- __id:
    - 0
    - 3
  name: File
  info: File with a text content. Accessible through the web filesystem.
  class_name: schemat.item.File
  fields:
    format:
      "@": schemat.type.STRING
    content:
      "@": schemat.type.CODE
    _is_file:
      default: true
      "@": schemat.type.BOOLEAN
  handlers:
    download: return this.read()   // full content of this File returned as plain text
- __id:
    - 0
    - 4
  name: FileLocal
  info: File located on a local disk, identified by its local file path.
  base_category:
    - 0
    - 3
  class_name: schemat.item.FileLocal
  fields:
    path:
      "@": schemat.type.STRING
- __id:
    - 0
    - 5
  name: Folder
  info: A directory of files, each file has a unique name (path). May contain
    nested directories.
  class_name: schemat.item.Folder
  fields:
    files:
      isCatalog: true
      keys:
        "@": schemat.type.FILENAME
      values:
        "@": schemat.type.ITEM
      "@": schemat.type.CATALOG
    _is_folder:
      default: true
      "@": schemat.type.BOOLEAN
- __id:
    - 0
    - 6
  name: FolderLocal
  info: |-
    File folder located on a local disk, identified by its local file path.
    Gives access to all files and folders beneath the path.
  base_category:
    - 0
    - 5
  class_name: schemat.item.FolderLocal
  fields:
    path:
      "@": schemat.type.STRING
- __id:
    - 0
    - 7
  name: Application
  info: Category of application records. An application groups all spaces &
    categories available in the system and provides system-level configuration.
  class_name: schemat.item.Application
  fields:
    name:
      "@": schemat.type.STRING
- __id:
    - 0
    - 8
  name: AppRoot
  info: A set of sub-applications, each bound to a different URL prefix.
  class_name: schemat.item.AppRoot
  base_category:
    - 0
    - 7
  fields:
    name:
      "@": schemat.type.STRING
    apps:
      isCatalog: true
      values:
        "@": schemat.type.ITEM
      "@": schemat.type.CATALOG
- __id:
    - 0
    - 9
  name: AppSystem
  info: Application that serves items on simple URLs of the form /CID:IID, for
    admin purposes.
  class_name: schemat.item.AppSystem
  fields:
    name:
      "@": schemat.type.STRING
- __id:
    - 0
    - 10
  name: AppFiles
  class_name: schemat.item.AppFiles
  fields:
    name:
      "@": schemat.type.STRING
    root_folder:
      category_base:
        =:
          - 0
          - 5
        "@": (item)
      "@": schemat.type.ITEM
- __id:
    - 0
    - 11
  name: AppSpaces
  info: "Application for accessing public data through verbose paths of the form:
    .../SPACE:IID, where SPACE is a text identifier assigned to a category in
    `spaces` property."
  class_name: schemat.item.AppSpaces
  fields:
    name:
      "@": schemat.type.STRING
    spaces:
      isCatalog: true
      values:
        category_exact:
          =:
            - 0
            - 0
          "@": (item)
        "@": schemat.type.ITEM
      "@": schemat.type.CATALOG
- __id:
    - 0
    - 12
  name: Site
  info: Category of site records. A site contains information about applications,
    servers, startup
  class_name: schemat.item.Site
  fields:
    name:
      "@": schemat.type.STRING
    base_url:
      info: Base URL at which the website is served, no trailing '/'
      "@": schemat.type.STRING
    system_path:
      info: A URL path that when appended to the `base_url` creates a URL of the
        system application, AppSystem - used for internal web access to items.
      "@": schemat.type.STRING
    application:
      info: Application hosted on this site, typically an AppRoot with multiple
        subapplications
      "@": schemat.type.ITEM
    filesystem:
      info: Root of the global file system
      category_base:
        =:
          - 0
          - 5
        "@": (item)
      "@": schemat.type.ITEM
    database:
      info: Global database layer
      category_base:
        =:
          - 0
          - 1
        "@": (item)
      "@": schemat.type.ITEM
- __id:
    - 0
    - 13
  name: Varia
  info: Category of items that do not belong to any specific category
  class_body: |
    
    static check() { console.log("Varia/class_body/check() successful") } 
    static error() { throw new Error('Varia/class_body/error()') }
  fields:
    name:
      "@": schemat.type.STRING
    title:
      "@": schemat.type.STRING
  handlers: {}
- __id:
    - 5
    - 1
  files:
    Site:
      - 0
      - 12
    File:
      - 0
      - 3
    Folder:
      - 0
      - 5
- __id:
    - 3
    - 1
  content: This is a test file.
- __id:
    - 5
    - 2
  files:
    test.txt:
      - 3
      - 1
- __id:
    - 5
    - 3
  files:
    tmp1:
      - 5
      - 2
- __id:
    - 2
    - 1
  filename: /home/marcin/Documents/priv/catalog/src/schemat/server/db.yaml
- __id:
    - 6
    - 1
  path: /home/marcin/Documents/priv/catalog/src/schemat
- __id:
    - 9
    - 1
  name: System
- __id:
    - 10
    - 1
  name: Files
- __id:
    - 11
    - 1
  name: Catalog
  spaces:
    sys.category: 0
    sys.item: 13
    sys.site: 12
    sys.dir: 5
    sys.file: 4
- __id:
    - 8
    - 1
  name: Applications
  apps:
    $:
      - 9
      - 1
    files:
      - 10
      - 1
    "":
      - 11
      - 1
- __id:
    - 12
    - 1
  name: catalog.wiki
  base_url: http://127.0.0.1:3000
  system_path: /$
  application:
    - 8
    - 1
  filesystem:
    - 6
    - 1
  database:
    - 2
    - 1
- __id:
    - 13
    - 1
  title: Ala ma kota Sierściucha i psa Kłapoucha.
- __id:
    - 13
    - 2
  title: ąłęÓŁŻŹŚ
